<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Register Sale</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="{{url_for('static', filename='style/register_sale.css')}}">
</head>
<body>
    <!-- Navbar Content -->
    <nav class="navbar navbar-dark bg-dark bg-gradient">
        <a class="navbar-brand" href="{{ url_for('home.homepage') }}">Entreprise Name</a>
        <ul class="nav">
            <li class="nav-item">
                <a class="nav-link-i nav-link" href="{{ url_for('register_sales.register_sales') }}">Sell</a>
            </li>
            <li class="nav-item">
                <a class="nav-link disabled nav-link-i" href="{{ url_for('view_sales.view_sales') }}">Sales Dashboard</a>
            </li>
            <li class="nav-item">
                <a class="nav-link disabled nav-link-i" href="{{ url_for('register_products.register_products') }}">Register Product</a>
            </li>
            <li class="nav-item">
                <a class="nav-link disabled nav-link-i" href="{{ url_for('register_users.register_users') }}">Register Customer</a>
            </li>
            <li class="nav-item">
                <form action="{{ url_for('logout.logout') }}" method="GET">
                    <button type="submit" class="btn btn-light btn-sm" onclick="">Logout</button>
                </form>
            </li>
        </ul>
    </nav>

    <div id="saleFormContent" style="visibility: visible;">
    <h1 id="TitleHead">Register Sale</h1>

    <form id="saleForm" class="container align-items-center justify-content-center" method="post">
        <!-- Fixed fields: User Registry and Item -->
        <div id="form-header" class="container form-inline row justify-content-center mb-1">
            <input hidden name="itemCounter" id="itemCounter" value="1">
            <input type="text" name="costumerRegistry" id="costumerRegistry" palceholder="Costumer Registry" class="form-control col-sm mr-1" style="max-width: 10%" onchange="getCostumer()" required>
            <input id="costumerName" placeholder="Costumer Name" class="form-control col-sm mr-1" style="max-width: 60%"required disabled>
        </div>

        <div id="items" class="form-inline container align-items-center justify-content-center border border-1 rounded p-1 bg-white">
            <div id="item1" class="form-row d-inline-flex row mb-1 mt-1">
                    <label for="barcode1" display: block>EAN:</label>
                    <input type="text" name="barcode1" id="barcode1" class="form-control mr-1" onchange= "getItem('1')" required>
                    
                    <input id="itemDescription1" placeholder="Item Description" class= "form-control mr-1" required disabled>

                    <label for="quantity1" display: block>Quantity:</label>
                    <input type="number" name="quantity1" id="quantity1" class="form-control mr-1" required disabled>
                
                    <label for="price1"display: block>Price:</label>
                    <input type="number" name="price1" id="price1" class="form-control mr-1" required disabled>
                    
                    <button type="button" class="btn btn-danger form-control" onclick="removeItem(1)" > X </button>
            </div>
        <!-- Dynamic fields for additional items -->
            <!-- JavaScript will add fields here 
        
            -->
        </div>
        <div id="buttonsDiv" class="container form-inline padding receipt_container align-items-center justify-content-center mt-1 mb-1">
            <button type="button" class="btn btn-primary mr-1" onclick="addItem()">Add Item</button>
            <button type="button" id="submitBtn" class="btn btn-success mr-1" onclick="validFields()">Submit</button>
            <button type="button" id="printBtn" class="btn mr-1" id="printSale" onclick="printReceipt()">Print</button>
            <button type="reset" id="resetBtn" class="btn btn-warning mr-1" onclick="cleanForm()">Reset</button>
        </div>
    </form>
    </div>
    <div id="receiptContainer" class="container" style="visibility: collapse;">
        <div id="receipt" name="receipt" class="receipt_container bg-white">
            <div class="header">
                <h2>Receipt</h2>
                <div id="sale_info">
                    <p class="header_item">Sale Store: <span id="RsaleStore"></span></p>
                    <p class="header_item">Sale ID: <span id="RsaleId"></span></p>
                    <p class="header_item">Seller Name: <span id="RsellerName"></span></p>
                    <p class="header_item">Sale Date: <span id="RsaleDate"></span></p>
                </div>
                <div id="costumer_info">
                    <p class="header_item">Costumer Registry: <span id="RcostumerRegistry"></span></p>
                    <p class="header_item">Costumer Name: <span id="RcostumerName"></span></p>
                    <p class="header_item">Costumer CPF: <span id="RcostumerCPF"></span></p>
                    <p class="header_item">Costumer Store: <span id="RcostumerStore"></span></p>
                </div>
            </div>

            <div class="body">
                <table id="items_info">
                    <thead>
                        <tr>
                            <th>Barcode</th>
                            <th>Item Description</th>
                            <th>Item Quantity</th>
                            <th>Price</th>
                            <th>Value</th>
                        </tr>
                    </thead>
                    <tbody id="itemsPDF">
                        <!-- Add dynamic rows for each item in the sale -->
    
                        <!-- Add more rows as needed -->
                    </tbody>
                </table>
            </div>

            <div id="footer" class="footer">
                <p class="header_item">Customer Signature: ___________________________</p>
                <p class="header_item">Total Value of Purchase: $<span id="totalValue">20.00</span></p>
            </div>
        </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.5.0-beta4/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='scripts/register_sale.js') }}"></script>
</body>
</html>